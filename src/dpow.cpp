//TODO port all dpow related bits into dpow.h and dpow.cpp